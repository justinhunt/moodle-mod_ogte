{"version":3,"file":"articleleveler.min.js","sources":["../src/articleleveler.js"],"sourcesContent":["\r\ndefine(['jquery', 'core/log','core/notification','core/str','core/templates','mod_ogte/utils','mod_ogte/clipboardhelper','mod_ogte/popoverhelper'],\r\n    function($, log,notification,str, templates, utils, clipboardhelper,popoverhelper) {\r\n    \"use strict\"; // jshint ;_;\r\n    /*\r\n    This file combines with the articleleveler.mustache template to create the article leveler\r\n     */\r\n\r\n    log.debug('OGTE Article: initialising');\r\n\r\n    var hiddenTextBox = $(\"input[name='text']\");\r\n    var hiddenListIdBox = $(\"input[name='listid']\");\r\n    var hiddenLevelIdBox = $(\"input[name='levelid']\");\r\n    var hiddenIgnoresBox = $(\"input[name='ignores']\");\r\n    var hiddenTitleBox = $(\"input[name='title']\");\r\n    var hiddenJSONRatingBox = $(\"input[name='jsonrating']\");\r\n    var passagebox= $('#the_al_passage');\r\n    var levelstats= $('#the_al_levelstats');\r\n    var articlestats= $('#the_al_articlestats');\r\n    var themessage= $('#the_al_message');\r\n    var thebutton= $('#the_al_button');\r\n    var listselect= $('#the_listselect');\r\n    var levelselect= $('#the_levelselect');\r\n    var addtoIgnoreButton = $('#the_addtoignore');\r\n    var downloadButton = $('.ogte_downloadbutton');\r\n    var sendToEditorButton = $('.ogte_ar_sendtoeditor_button')\r\n    var ignorelist = $('#the_ignorelist');\r\n    var statusmessage =$('#the_al_status_message');\r\n    var outoflistwords_block =$('#the_outoflistwords');\r\n    var outoflevelwords_block =$('#the_outoflevelwords');\r\n    var ignoredwords_block =$('#the_ignoredwords');\r\n    var outoflevelfreq_block =$('#the_outoflevelfreq');\r\n\r\n    var app= {\r\n\r\n        strings:{},\r\n        opts: {},\r\n\r\n        //initialize\r\n        init: function (props) {\r\n            log.debug('initializing article leveler');\r\n\r\n            //pick up opts from html\r\n            var theid = '#' + props.optsid;\r\n            var configcontrol = $(theid).get(0);\r\n            if (configcontrol) {\r\n                this.opts = JSON.parse(configcontrol.value);\r\n                $(theid).remove();\r\n            } else {\r\n                //if there is no config we might as well give up\r\n                log.debug('No config found on page. Giving up.');\r\n                return;\r\n            }\r\n\r\n            this.init_strings();\r\n            this.registerEvents();\r\n            clipboardhelper.init({});\r\n\r\n            //JSON rating\r\n            var jsonrating_string = hiddenJSONRatingBox.val();\r\n            log.debug('is json?');\r\n            if (this.isJSON(jsonrating_string)) {\r\n                log.debug('yes json');\r\n                var jsonrating = JSON.parse(jsonrating_string);\r\n                log.debug('is level stats');\r\n                if (jsonrating.hasOwnProperty('passage')) {\r\n                    log.debug('yes level stats');\r\n                    this.updateAllFromJSONRating(jsonrating);\r\n                }\r\n            }\r\n            //List and Level ID\r\n            var listid = hiddenListIdBox.val();\r\n            var levelid = hiddenLevelIdBox.val();\r\n            if (listid !== '' && levelid !== '') {\r\n                listselect.val(listid);\r\n                levelselect.val(levelid);\r\n            }else{\r\n                var listid = listselect.val();\r\n                this.updateLevelDropdown(listid);\r\n            }\r\n            //Ignores\r\n            var ignores = hiddenIgnoresBox.val();\r\n            if (ignores !== '') {\r\n                ignorelist.val(ignores);\r\n            }\r\n\r\n            //init the popover now that we have set the correct callback event handling thingies\r\n            popoverhelper.init();\r\n        },\r\n\r\n\r\n        //init strings\r\n        init_strings: function(){\r\n            var that =this;\r\n            var strs=['alreadyignored','selecttoignore','doignore', 'entersomething','texttoolong5000',\r\n                'ignored','outoflist','outoflevel','outoflevelfreq'];\r\n            for (var key in strs) {\r\n                ///log.debug('getting string: ' + strs[key]);\r\n                var thestring = strs[key];\r\n                str.get_string(thestring,'mod_ogte').done(function(s){that.strings[thestring]=s;});\r\n            }\r\n\r\n            //Promises are promises and jsonrating cant wait around for them, so we hack it\r\n            that.strings.alreadyignored = \"Already Ignored\";\r\n            that.strings.selecttoignore = \"Select to Ignore\";\r\n            that.strings.doignore = \"Ignore\";\r\n            that.strings.entersomething = \"Enter something\";\r\n            that.strings.texttoolong5000 = \"Text too long (5000 characters max)\";\r\n            that.strings.ignored = \"Ignored\";\r\n            that.strings.outoflist = \"Out of List\";\r\n            that.strings.outoflevel = \"Out of Level\";\r\n            that.strings.outoflevelfreq =  \"% Out of Level\";\r\n\r\n            // Set up strings\r\n            str.get_strings([\r\n                { \"key\": \"alreadyignored\", \"component\": 'mod_ogte'},\r\n                { \"key\": \"selecttoignore\", \"component\": 'mod_ogte'},\r\n                { \"key\": 'doignore', \"component\": 'mod_ogte' },\r\n                { \"key\": 'entersomething', \"component\": 'mod_ogte'},\r\n                { \"key\": 'texttoolong5000', \"component\": 'mod_ogte' },\r\n                { \"key\": 'ignored', \"component\": 'mod_ogte' },\r\n                { \"key\": 'outoflist', \"component\": 'mod_ogte'},\r\n                { \"key\": 'outoflevel', \"component\": 'mod_ogte' },\r\n                { \"key\": 'outoflevelfreq', \"component\": 'mod_ogte'},\r\n                \r\n            ]).done(function (s) {\r\n                var i = 0;\r\n                that.strings.alreadyignored = s[i++];\r\n                that.strings.selecttoignore = s[i++];\r\n                that.strings.doignore = s[i++];\r\n                that.strings.entersomething = s[i++];\r\n                that.strings.texttoolong5000 = s[i++];\r\n                that.strings.ignored = s[i++];\r\n                that.strings.outoflist = s[i++];\r\n                that.strings.outoflevel = s[i++];\r\n                that.strings.outoflevelfreq = s[i++];\r\n            });\r\n        },\r\n\r\n        //Update Stats and Analysis\r\n        updateAllFromJSONRating: function (jsonrating) {\r\n            log.debug('updateAllFromJSONRating');\r\n            themessage.text('');\r\n            passagebox.html(jsonrating.passage);\r\n\r\n            // Add level stats to the page\r\n            jsonrating.listname=app.opts.listlevels[jsonrating.listid][jsonrating.levelid].listname;\r\n            jsonrating.levelname=app.opts.listlevels[jsonrating.listid][jsonrating.levelid].label;\r\n            templates.render('mod_ogte/levelstatstable', jsonrating).done(function(html, js) {\r\n\r\n                // Update the page.\r\n                levelstats.fadeOut(\"fast\", function() {\r\n                    templates.replaceNodeContents(levelstats, html, js);\r\n                    levelstats.fadeIn(\"fast\");\r\n                }.bind(this));\r\n\r\n            }.bind(this)).fail(notification.exception);\r\n\r\n            //add text stats to the page\r\n            var textStatsData = utils.analyzeText(jsonrating.passage);\r\n            templates.render('mod_ogte/textstatstable', textStatsData).done(function(html, js) {\r\n\r\n                    // Update the page.\r\n                articlestats.fadeOut(\"fast\", function() {\r\n                        templates.replaceNodeContents(articlestats, html, js);\r\n                    articlestats.fadeIn(\"fast\");\r\n                    }.bind(this));\r\n\r\n            }.bind(this)).fail(notification.exception);\r\n\r\n            //add more coverage stats to the page as blocks\r\n            var ignoredAndOutOfData = utils.analyzeOutListLevelsIgnored(jsonrating.passage);\r\n\r\n            //out of list words block\r\n            outoflistwords_block.show();\r\n            templates.render('mod_ogte/block_uncovered',\r\n                {words: ignoredAndOutOfData.outoflist,haswords: ignoredAndOutOfData.outoflist.length>0, haslevels: false, title: this.strings.outoflist}).done(function(html, js) {\r\n\r\n                // Update the page.\r\n                outoflistwords_block.fadeOut(\"fast\", function() {\r\n                    templates.replaceNodeContents(outoflistwords_block, html, js);\r\n                    outoflistwords_block.fadeIn(\"fast\");\r\n                }.bind(this));\r\n\r\n            }.bind(this)).fail(notification.exception);\r\n\r\n            //out of level words block\r\n            outoflevelwords_block.show();\r\n            templates.render('mod_ogte/block_uncovered',\r\n                {words: ignoredAndOutOfData.outoflevel, haswords: ignoredAndOutOfData.outoflevel.length>0, haslevels: true, title: this.strings.outoflevel}).done(function(html, js) {\r\n\r\n                // Update the page.\r\n                outoflevelwords_block.fadeOut(\"fast\", function() {\r\n                    templates.replaceNodeContents(outoflevelwords_block, html, js);\r\n                    outoflevelwords_block.fadeIn(\"fast\");\r\n                }.bind(this));\r\n\r\n            }.bind(this)).fail(notification.exception);\r\n\r\n            //ignored words block\r\n            ignoredwords_block.show();\r\n            templates.render('mod_ogte/block_uncovered',\r\n                {words: ignoredAndOutOfData.ignored, haswords: ignoredAndOutOfData.ignored.length>0, haslevels: false,title: this.strings.ignored}).done(function(html, js) {\r\n\r\n                // Update the page.\r\n                ignoredwords_block.fadeOut(\"fast\", function() {\r\n                    templates.replaceNodeContents(ignoredwords_block, html, js);\r\n                    ignoredwords_block.fadeIn(\"fast\");\r\n                }.bind(this));\r\n\r\n            }.bind(this)).fail(notification.exception);\r\n\r\n            //out of level frequency block\r\n            var outOfLevelFreqData = utils.calc_outoflevel_frequencies(jsonrating.passage);\r\n            outoflevelfreq_block.show();\r\n            templates.render('mod_ogte/block_outoflevelfreq',\r\n                {levels: outOfLevelFreqData,haslevels: outOfLevelFreqData.length>0, title: this.strings.outoflevelfreq}).done(function(html, js) {\r\n\r\n                // Update the page.\r\n                outoflevelfreq_block.fadeOut(\"fast\", function() {\r\n                    templates.replaceNodeContents(outoflevelfreq_block, html, js);\r\n                    outoflevelfreq_block.fadeIn(\"fast\");\r\n                }.bind(this));\r\n\r\n            }.bind(this)).fail(notification.exception);\r\n\r\n        },\r\n\r\n\r\n        //is the string JSON?\r\n        isJSON:  function (str) {\r\n            try {\r\n                JSON.parse(str);\r\n                return true;\r\n            } catch (e) {\r\n                return false;\r\n            }\r\n        },\r\n\r\n        //Get selected text in the editable div\r\n        getSelectedText:  function () {\r\n            var selectedText = \"\";\r\n            if (window.getSelection) {\r\n                selectedText = window.getSelection().toString();\r\n            } else if (document.selection && document.selection.type !== \"Control\") {\r\n                selectedText = document.selection.createRange().text;\r\n            }\r\n            return selectedText;\r\n        },\r\n\r\n        // Function to update the options in the second dropdown based on the selection in the first dropdown\r\n        updateLevelDropdown: function () {\r\n            const selectedList = listselect.val();\r\n            log.debug('selected list: ' + selectedList);\r\n            // Clear existing options\r\n            levelselect.empty();\r\n\r\n            // Populate options based on the selected category\r\n            app.opts.listlevels[selectedList].forEach(function (option) {\r\n                levelselect.append($('<option value=\"' +option.key+'\">' + option.label+ '</option>'));\r\n            });\r\n            levelselect.prop('selectedIndex', 0);\r\n            hiddenListIdBox.val(selectedList);\r\n            hiddenLevelIdBox.val(levelselect.val());\r\n        },\r\n\r\n        setStatusMessage: function (message) {\r\n            statusmessage.text(message);\r\n            setTimeout(function () {\r\n                statusmessage.fadeOut();\r\n            },2000);\r\n        },\r\n\r\n        doPopover: function (that,e) {\r\n            if(e.target.tagName === \"SPAN\" || e.target.tagName === \"DIV\") {\r\n                var selectedText = $(that).text();\r\n            }else if (e.target.tagName === \"INPUT\" || e.target.tagName === \"TEXTAREA\") {\r\n                var selectedText = that.getSelectedText();\r\n            }\r\n\r\n            if (selectedText === '') {\r\n                addtoIgnoreButton.hide();\r\n                return;\r\n            } else {\r\n                var word = selectedText.trim();\r\n                //we only single words\r\n                if (word.includes(\" \")) {\r\n                    addtoIgnoreButton.hide();\r\n                    return;\r\n                }\r\n                //we only want words that we did not ignore yet\r\n                var ignores = ignorelist.val();\r\n                if (ignores.toLowerCase().includes(word.toLowerCase())) {\r\n                    app.setStatusMessage(app.strings[\"alreadyignored\"] + word);\r\n                    addtoIgnoreButton.hide();\r\n                    return;\r\n                }\r\n\r\n                //if we get here its ignorable\r\n                statusmessage.text(\"\");\r\n                //show the ignore button .. old code\r\n                addtoIgnoreButton.text(app.strings[\"doignore\"] + word);\r\n                addtoIgnoreButton.data(\"ignore\", word);\r\n                addtoIgnoreButton.show();\r\n                //show the popover\r\n                if (!popoverhelper.isShowing(that)) {\r\n                    popoverhelper.doPopup(that,selectedText );\r\n                }else{\r\n                    popoverhelper.doPopup(that, selectedText );\r\n                }\r\n            }\r\n        },\r\n\r\n        //Register Event Handlers\r\n        registerEvents: function () {\r\n            var that=this;\r\n            addtoIgnoreButton.on('click', function (e) {\r\n                var word = utils.getSelectedWord();\r\n                if (word !== '') {\r\n                    var newignorelist = ignorelist.val() + ' ' + word;\r\n                    ignorelist.val(newignorelist);\r\n                    hiddenIgnoresBox.val(newignorelist);\r\n                    app.setStatusMessage(app.strings[\"alreadyignored\"] + word);\r\n                    addtoIgnoreButton.hide();\r\n                }\r\n            });\r\n\r\n            downloadButton.on('click', function (e) {\r\n                var target_selector = $(this).attr('data-download-target');\r\n                var text = $(target_selector).text();\r\n\r\n                var filename='article.txt';\r\n                var filename_selector = $(this).attr('data-download-filename');\r\n                if(filename_selector!=='' && filename_selector!==undefined) {\r\n                    filename = $(filename_selector).val() + '.txt';\r\n                    filename=filename.trim().replace(/ /g,\"_\");\r\n                }\r\n                utils.downloadTextContent(text, filename);\r\n            });\r\n\r\n            sendToEditorButton.on('click',function(){\r\n\r\n                //get the article text to update\r\n                var target_selector = $(this).attr('data-send-target');\r\n                var text = $(target_selector).val();\r\n\r\n                //set the text to the article leveler and level it\r\n                passagebox.text(text);\r\n                hiddenTextBox.val(text);\r\n                thebutton.click();\r\n\r\n                //switch to the article leveler tab\r\n                $('.mod_ogte_tab-content .tab-pane').removeClass('active');\r\n                $('.mod_ogte_tab-content #articleleveler').addClass('active');\r\n                $('.mod_ogte_nav-pills .nav-link').removeClass('active');\r\n                $('.mod_ogte_nav-pills a[href=\"#articleleveler\"]').addClass('active');\r\n                $('#articleleveler').tab('show');\r\n\r\n            });\r\n\r\n            //prevent the editable div from creating more divs on copy and paste\r\n            passagebox.on('paste', function (e) {\r\n                e.preventDefault();\r\n                var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                // Insert plain text without additional divs\r\n                $(this).text(text);\r\n                //also update our hidden text box\r\n                hiddenTextBox.val($(this).text());\r\n            });\r\n\r\n            //Add the text to the hidden text box used to submit the form when text is edited\r\n            passagebox.on('input', function (e) {\r\n                var thetext = $(this)[0].innerText;\r\n                hiddenTextBox.val(thetext);\r\n            });\r\n/*\r\n            passagebox.on('mouseup', function (e) {\r\n                that.doPopover(this,e);\r\n            });\r\n*/\r\n            passagebox.on('click','span', function (e) {\r\n                that.doPopover(this,e);\r\n            });\r\n\r\n            //Add the ignores list to the hidden text box used to submit the form when text is edited\r\n            ignorelist.on('change', function (e) {\r\n                hiddenIgnoresBox.val($(this).val());\r\n            });\r\n\r\n            listselect.on('change', function (e) {\r\n                var listid =  $(this).val();\r\n                hiddenListIdBox.val(listid);\r\n                that.updateLevelDropdown();\r\n            });\r\n\r\n            //Level select on change\r\n            levelselect.on('change', function (e) {\r\n                var levelid =  $(this).val();\r\n                hiddenLevelIdBox.val(levelid);\r\n            });\r\n\r\n\r\n            thebutton.on('click', function () {\r\n                //show a spinner\r\n                themessage.html('<i class=\"fa fa-spinner fa-spin fa-sm\"></i>');\r\n\r\n                //get text and clean it up\r\n                //TO DO there will be more cleaning to do.\r\n                var thepassage = passagebox[0].innerText;\r\n\r\n                //no super long readings or empty ones\r\n                if (!thepassage || thepassage.trim() === '') {\r\n                    themessage.text(app.strings['entersomething']);\r\n                    return;\r\n                }\r\n                if (thepassage.length > 50000) {\r\n                    themessage.text(app.strings['texttoolong5000']);\r\n                    return;\r\n                }\r\n                var language = 'en-US';\r\n\r\n                var ignore = ignorelist.val();\r\n                var listid = listselect.val();\r\n                var listlevel = levelselect.val();\r\n                var ogteid=app.opts.ogteid;\r\n\r\n                utils.levelPassage(thepassage, ignore, listid, listlevel, ogteid).then(function (ajaxresult) {\r\n                    var theresponse = JSON.parse(ajaxresult);\r\n                    if (theresponse) {\r\n                        hiddenJSONRatingBox.val(ajaxresult);\r\n                        that.updateAllFromJSONRating(theresponse);\r\n                    } else {\r\n                        log.debug('ajax call to level coverage failed');\r\n                    }\r\n                });//end of level passage\r\n            });//end of click\r\n\r\n        },\r\n\r\n    };\r\n    return app;\r\n\r\n});"],"names":["define","$","log","notification","str","templates","utils","clipboardhelper","popoverhelper","debug","hiddenTextBox","hiddenListIdBox","hiddenLevelIdBox","hiddenIgnoresBox","hiddenJSONRatingBox","passagebox","levelstats","articlestats","themessage","thebutton","listselect","levelselect","addtoIgnoreButton","downloadButton","sendToEditorButton","ignorelist","statusmessage","outoflistwords_block","outoflevelwords_block","ignoredwords_block","outoflevelfreq_block","app","strings","opts","init","props","theid","optsid","configcontrol","get","JSON","parse","value","remove","init_strings","registerEvents","jsonrating_string","val","this","isJSON","jsonrating","hasOwnProperty","updateAllFromJSONRating","listid","levelid","updateLevelDropdown","ignores","that","strs","key","thestring","get_string","done","s","alreadyignored","selecttoignore","doignore","entersomething","texttoolong5000","ignored","outoflist","outoflevel","outoflevelfreq","get_strings","i","text","html","passage","listname","listlevels","levelname","label","render","js","fadeOut","replaceNodeContents","fadeIn","bind","fail","exception","textStatsData","analyzeText","ignoredAndOutOfData","analyzeOutListLevelsIgnored","show","words","haswords","length","haslevels","title","outOfLevelFreqData","calc_outoflevel_frequencies","levels","e","getSelectedText","selectedText","window","getSelection","toString","document","selection","type","createRange","selectedList","empty","forEach","option","append","prop","setStatusMessage","message","setTimeout","doPopover","target","tagName","word","trim","includes","toLowerCase","hide","data","isShowing","doPopup","on","getSelectedWord","newignorelist","target_selector","attr","filename","filename_selector","undefined","replace","downloadTextContent","click","removeClass","addClass","tab","preventDefault","originalEvent","clipboardData","getData","thetext","innerText","thepassage","ignore","listlevel","ogteid","levelPassage","then","ajaxresult","theresponse"],"mappings":"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"}